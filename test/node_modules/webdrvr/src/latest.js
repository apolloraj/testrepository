var request = require('request');

var GOOGLE_STORAGE_URL = 'https://www.googleapis.com/storage/v1beta2/b';

function findLatest(versions) {
  return versions.reduce(function(prevVersion, version) {
    if (prevVersion < version) {
      return version;
    } else {
      return prevVersion;
    }
  }, '');
}

request.get({
  url: GOOGLE_STORAGE_URL + '/selenium-release/o?delimiter=/',
  json: true
}, function(error, response, body) {
  console.log('latest', findLatest(body.prefixes));
  console.log(body.prefixes);
});

request.get({
  url: GOOGLE_STORAGE_URL + '/chromedriver/o?delimiter=/',
  json: true
}, function(error, response, body) {
  console.log('latest', findLatest(body.prefixes));
  console.log(body.prefixes);
});

request.get({
  url: GOOGLE_STORAGE_URL + '/chromedriver/o?prefix=2.9',
  json: true
}, function(error, response, body) {
  console.log(body.items.map(function(i) {
    return i.mediaLink;
  }));
});

request.get({
  url: GOOGLE_STORAGE_URL + '/selenium-release/o?prefix=2.41',
  json: true
}, function(error, response, body) {
  console.log(body.items.map(function(i) {
    return i.mediaLink;
  }));
});
